<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>シンプル瞑想タイマー</title>
    <style>
      body {
        background: #000;
        color: #fff;
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        height: 100vh;
        margin: 0;
        padding: 20px;
      }

      .container {
        text-align: center;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      .time-inputs {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin: 30px 0;
      }

      input {
        width: 60px;
        padding: 10px;
        font-size: 1.5rem;
        text-align: center;
        background: #333;
        border: 2px solid #ff9500;
        color: #fff;
        border-radius: 8px;
      }

      .timer-display {
        font-size: 4rem;
        margin: 30px 0;
        letter-spacing: 3px;
      }

      .buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
      }

      button {
        padding: 15px 30px;
        font-size: 1.2rem;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        transition: opacity 0.3s;
      }

      button:hover {
        opacity: 0.8;
      }

      #startBtn {
        background: #2ecc71;
        color: white;
      }
      #pauseBtn {
        background: #f1c40f;
        color: black;
      }
      #resetBtn {
        background: #e74c3c;
        color: white;
      }

      .hidden {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="time-inputs">
        <input type="number" id="minutes" min="0" value="15" placeholder="分" />
        <input type="number" id="seconds" min="0" value="0" placeholder="秒" />
      </div>

      <div class="timer-display" id="display">15:00</div>

      <div class="buttons">
        <button id="resetBtn" class="hidden">キャンセル</button>
        <button id="startBtn">開始</button>
        <button id="pauseBtn" class="hidden">一時停止</button>
      </div>
    </div>

    <audio
      id="alarm"
      src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"
    ></audio>

    <script>
      let timer;
      let remainingTime = 0;
      const display = document.getElementById("display");
      const alarm = document.getElementById("alarm");

      // 入力値の検証
      function validateInput(input) {
        input.value = input.value.replace(/[^0-9]/g, "");
        if (input.value > 59) input.value = 59;
        if (input.value < 0) input.value = 0;
      }

      // タイマー更新
      function updateDisplay(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        display.textContent = `${String(mins).padStart(2, "0")}:${String(
          secs
        ).padStart(2, "0")}`;
      }

      // タイマー開始
      function startTimer() {
        const minutes = parseInt(document.getElementById("minutes").value) || 0;
        const seconds = parseInt(document.getElementById("seconds").value) || 0;
        remainingTime = minutes * 60 + seconds;

        if (remainingTime <= 0) return;

        document.getElementById("startBtn").classList.add("hidden");
        document.getElementById("pauseBtn").classList.remove("hidden");
        document.getElementById("resetBtn").classList.remove("hidden");

        const startTime = Date.now();
        const endTime = startTime + remainingTime * 1000;

        timer = setInterval(() => {
          remainingTime = Math.round((endTime - Date.now()) / 1000);

          if (remainingTime <= 0) {
            clearInterval(timer);
            alarm.play();
            resetTimer();
          }

          updateDisplay(remainingTime > 0 ? remainingTime : 0);
        }, 100);
      }

      // タイマーリセット
      function resetTimer() {
        clearInterval(timer);
        document.getElementById("startBtn").classList.remove("hidden");
        document.getElementById("pauseBtn").classList.add("hidden");
        document.getElementById("resetBtn").classList.add("hidden");
        updateDisplay(
          parseInt(document.getElementById("minutes").value) * 60 +
            parseInt(document.getElementById("seconds").value)
        );
      }

      // イベントリスナー
      document.getElementById("startBtn").addEventListener("click", startTimer);
      document.getElementById("pauseBtn").addEventListener("click", () => {
        clearInterval(timer);
        document.getElementById("startBtn").classList.remove("hidden");
        document.getElementById("pauseBtn").classList.add("hidden");
      });
      document.getElementById("resetBtn").addEventListener("click", resetTimer);

      // 入力検証
      document
        .getElementById("minutes")
        .addEventListener("input", (e) => validateInput(e.target));
      document
        .getElementById("seconds")
        .addEventListener("input", (e) => validateInput(e.target));
    </script>
  </body>
</html>
